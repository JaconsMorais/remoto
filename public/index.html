<!doctype html>
<html>
  <head>
    <title>term.js</title>
  </head>
  <body>
    <script src="js/term.js"></script>
    <script src="//js.pusher.com/3.1/pusher.min.js"></script>
    <script>
    ;(function() {
      window.onload = function() {
        var socket = new WebSocket("ws://localhost:8080/?type=remote");
        socket.onopen = function () {
          socket.send("\n")
        }

        socket.onmessage = function (message) {
          term.write(message.data)
        }

        socket.onerror = function () {
          term.destroy()
        }

        var term = new Terminal({
          cols: 80,
          rows: 24,
          useStyle: true,
          screenKeys: true,
          cursorBlink: true
        })
        term.on('data', function (data) {
          // term.write(data)
          socket.send(data)
        })
        term.on('title', function(title) {
          document.title = title
        })
        term.open(document.body)
        term.write('\x1b[31mWelcome!\x1b[m\r\n')

        window.term = term;

      };
    }).call(this);
    </script>
  </body>
</html>